<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>New Tab</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
      /* Base styles and Fluid Typography */
      html {
        font-size: clamp(14px, 1.5vw + 8px, 18px);
      }
      html.font-size-small {
        font-size: clamp(12px, 1.5vw + 7px, 16px);
      }
      html.font-size-large {
        font-size: clamp(16px, 1.5vw + 9px, 22px);
      }

      body {
        font-family: "Inter", sans-serif;
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      /* Refined font sizes for better balance */
      #greeting {
        font-size: 2.1rem;
      }
      #clock {
        font-size: 3.5rem;
      }
      #search-input {
        font-size: 1.125rem;
      }
      .widget-item {
        font-size: 1rem;
      }
      .bookmark-pill {
        font-size: 0.875rem;
      }

      @media (min-width: 640px) {
        #greeting {
          font-size: 2.5rem;
        }
        #clock {
          font-size: 4.5rem;
        }
      }

      /* Custom animation for background */
      @keyframes zoompan {
        0% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }

      /* Background container */
      .background-image {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        background-size: cover;
        background-position: center;
        z-index: -1;
        animation: zoompan 20s ease-in-out forwards;
        transition: background-image 1s ease-in-out, background-color 0.5s ease;
      }

      /* Glassmorphism effect */
      .glass-card {
        background-color: rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Smooth transitions for all elements */
      * {
        transition: color 0.3s ease, background-color 0.3s ease,
          border-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease,
          opacity 0.3s ease;
      }

      /* Page load animations */
      @keyframes fade-in-up {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .animate-on-load {
        opacity: 0;
        animation: fade-in-up 0.5s ease-out forwards;
      }

      /* Interactive element animations */
      .widget-item:hover {
        transform: translateX(4px);
      }
      .bookmark-pill:hover {
        background-color: rgba(255, 255, 255, 0.2);
      }
      #engine-toggle:hover {
        transform: scale(1.15);
      }
      #search-form .glass-card:has(#search-input:focus) {
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.3);
      }

      /* Modal styles */
      .modal.hidden {
        display: none;
      }
    </style>
  </head>
  <body class="bg-gray-900 text-white overflow-hidden">
    <div id="background-image" class="background-image"></div>
    <div class="fixed inset-0 bg-black/50"></div>

    <!-- Top Right Icons -->
    <div class="fixed top-4 right-4 z-30 flex items-center space-x-2">
      <button
        id="help-btn"
        class="p-2 rounded-full text-white/70 hover:text-white hover:bg-white/20 transition-all"
      >
        <i data-lucide="help-circle" class="w-6 h-6"></i>
      </button>
      <button
        id="settings-btn"
        class="p-2 rounded-full text-white/70 hover:text-white hover:bg-white/20 transition-all"
      >
        <i data-lucide="settings" class="w-6 h-6"></i>
      </button>
    </div>

    <!-- Main Content -->
    <main
      class="relative z-10 flex flex-col justify-center h-screen p-8 sm:p-12 lg:p-16"
    >
      <div class="w-full max-w-md flex flex-col items-start space-y-6">
        <div
          class="text-left w-full animate-on-load"
          style="animation-delay: 100ms"
        >
          <h1 id="greeting" class="font-bold tracking-tight"></h1>
          <p id="clock" class="font-bold"></p>
        </div>

        <form
          id="search-form"
          class="w-full animate-on-load"
          style="animation-delay: 200ms"
        >
          <div
            class="relative flex items-center glass-card rounded-full shadow-lg"
          >
            <button
              type="button"
              id="engine-toggle"
              class="p-3 sm:p-4 rounded-full text-white/80 hover:text-white"
            >
              <svg
                id="brave-icon"
                class="h-5 w-5 sm:h-6 sm:w-6"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M16.5 6.375L9.375 12l7.125 5.625V18l-9-7.031v-1.938l9-7.031V6.375zM7.5 18H6V6h1.5v12z"
                ></path>
              </svg>
              <svg
                id="google-icon"
                class="h-5 w-5 sm:h-6 sm:w-6 hidden"
                viewBox="0 0 24 24"
                fill="none"
              >
                <path
                  d="M21.35 11.1H12.18V13.83H18.68C18.36 17.64 15.19 19.27 12.19 19.27C8.36 19.27 5.03 16.25 5.03 12.55C5.03 8.85 8.36 5.83 12.19 5.83C14.27 5.83 15.99 6.62 17.33 7.84L19.46 5.82C17.62 4.09 15.11 3 12.19 3C7.03 3 3 7.54 3 12.55C3 17.56 7.03 22.1 12.19 22.1C17.63 22.1 21.69 18.06 21.69 12.82C21.69 12.03 21.54 11.56 21.35 11.1Z"
                  fill="#ffffff"
                ></path>
              </svg>
            </button>
            <input
              type="text"
              id="search-input"
              class="w-full bg-transparent text-white placeholder-white/60 py-3 sm:py-4 focus:outline-none pr-4 sm:pr-6"
              placeholder="Search with Brave"
              autocomplete="off"
            />
          </div>
        </form>

        <div
          class="flex flex-col items-start space-y-3 animate-on-load"
          style="animation-delay: 300ms"
        >
          <div class="flex items-center space-x-3 widget-item">
            <i data-lucide="calendar-days" class="w-5 h-5 opacity-80"></i>
            <span id="date"></span>
          </div>
          <div class="flex items-center space-x-3 widget-item">
            <span id="weather-icon-wrapper"
              ><i
                data-lucide="loader"
                class="w-5 h-5 opacity-80 animate-spin"
              ></i
            ></span>
            <span id="weather">Loading...</span>
          </div>
        </div>

        <div
          id="bookmarks-container"
          class="w-full flex flex-wrap gap-2 animate-on-load"
          style="animation-delay: 400ms"
        ></div>
      </div>
    </main>

    <!-- GitHub Footer -->
    <footer
      class="fixed bottom-4 right-4 z-20 animate-on-load"
      style="animation-delay: 500ms"
    >
      <a
        href="https://github.com/vaibhavrocxx/Browser-Homepage"
        target="_blank"
        rel="noopener noreferrer"
        class="flex items-center space-x-2 text-white/50 hover:text-white/80"
      >
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
          <path
            fill-rule="evenodd"
            d="M12 2C6.477 2 2 6.477 2 12c0 4.418 2.865 8.168 6.839 9.492.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.031-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.378.203 2.398.1 2.651.64.7 1.03 1.595 1.03 2.688 0 3.848-2.338 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.001 10.001 0 0022 12c0-5.523-4.477-10-10-10z"
            clip-rule="evenodd"
          />
        </svg>
        <span class="text-sm font-medium">Hosted on GitHub</span>
      </a>
    </footer>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden fixed inset-0 z-40">
      <div
        class="modal-overlay absolute inset-0 bg-black/60 backdrop-blur-sm"
      ></div>
      <div class="relative z-50 flex items-center justify-center h-full p-4">
        <div
          class="glass-card rounded-2xl p-6 md:p-8 w-full max-w-md space-y-6"
        >
          <div class="flex justify-between items-center">
            <h2 class="text-2xl font-bold">Settings</h2>
            <button class="modal-close-btn p-1">
              <i data-lucide="x" class="w-6 h-6"></i>
            </button>
          </div>
          <div class="space-y-4">
            <div>
              <label
                for="name-input"
                class="block text-sm font-medium text-white/80 mb-2"
                >Name</label
              ><input
                type="text"
                id="name-input"
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-white/50"
              />
            </div>
            <div>
              <label
                for="location-input"
                class="block text-sm font-medium text-white/80 mb-2"
                >Weather Location</label
              ><input
                type="text"
                id="location-input"
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2"
                placeholder="e.g., Pune"
              />
            </div>
            <div>
              <label
                for="clock-format-select"
                class="block text-sm font-medium text-white/80 mb-2"
                >Clock Format</label
              ><select
                id="clock-format-select"
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 appearance-none"
              >
                <option value="12h">12-Hour</option>
                <option value="24h">24-Hour</option>
              </select>
            </div>
            <div>
              <label
                for="font-size-select"
                class="block text-sm font-medium text-white/80 mb-2"
                >Font Size</label
              ><select
                id="font-size-select"
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 appearance-none"
              >
                <option value="small">Small</option>
                <option value="medium">Medium</option>
                <option value="large">Large</option>
              </select>
            </div>
          </div>
          <div class="flex justify-end">
            <button
              id="settings-save-btn"
              class="bg-white text-black font-semibold px-6 py-2 rounded-lg hover:bg-gray-200"
            >
              Save
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal hidden fixed inset-0 z-40">
      <div
        class="modal-overlay absolute inset-0 bg-black/60 backdrop-blur-sm"
      ></div>
      <div class="relative z-50 flex items-center justify-center h-full p-4">
        <div
          class="glass-card rounded-2xl p-6 md:p-8 w-full max-w-md space-y-4"
        >
          <div class="flex justify-between items-center">
            <h2 class="text-2xl font-bold">Quick Guide</h2>
            <button class="modal-close-btn p-1">
              <i data-lucide="x" class="w-6 h-6"></i>
            </button>
          </div>
          <ul class="space-y-3 text-white/90">
            <li class="flex items-start">
              <i data-lucide="image" class="w-5 h-5 mr-3 mt-1 shrink-0"></i
              ><span
                ><b>Daily Refresh:</b> Enjoy a new background image every
                day.</span
              >
            </li>
            <li class="flex items-start">
              <i data-lucide="search" class="w-5 h-5 mr-3 mt-1 shrink-0"></i
              ><span
                ><b>Switch Search:</b> Click the icon in the search bar to
                toggle between Brave and Google.</span
              >
            </li>
            <li class="flex items-start">
              <i
                data-lucide="bookmark-plus"
                class="w-5 h-5 mr-3 mt-1 shrink-0"
              ></i
              ><span
                ><b>Bookmarks:</b> Click a pill to visit the site. Use the `+`
                button to add new ones. Hover over a bookmark and click the
                pencil icon to edit or delete it.</span
              >
            </li>
            <li class="flex items-start">
              <i data-lucide="settings-2" class="w-5 h-5 mr-3 mt-1 shrink-0"></i
              ><span
                ><b>Customize:</b> Click the Settings icon to change your name,
                location, clock style, and font size. Your choices are saved
                automatically.</span
              >
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Bookmark Modal -->
    <div id="bookmark-modal" class="modal hidden fixed inset-0 z-40">
      <div
        class="modal-overlay absolute inset-0 bg-black/60 backdrop-blur-sm"
      ></div>
      <div class="relative z-50 flex items-center justify-center h-full p-4">
        <div
          class="glass-card rounded-2xl p-6 md:p-8 w-full max-w-md space-y-6"
        >
          <div class="flex justify-between items-center">
            <h2 id="bookmark-modal-title" class="text-2xl font-bold">
              Add Bookmark
            </h2>
            <button class="modal-close-btn p-1">
              <i data-lucide="x" class="w-6 h-6"></i>
            </button>
          </div>
          <div class="space-y-4">
            <input type="hidden" id="bookmark-id-input" />
            <div>
              <label
                for="bookmark-name-input"
                class="block text-sm font-medium text-white/80 mb-2"
                >Name</label
              >
              <input
                type="text"
                id="bookmark-name-input"
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-white/50"
              />
            </div>
            <div>
              <label
                for="bookmark-url-input"
                class="block text-sm font-medium text-white/80 mb-2"
                >URL</label
              >
              <input
                type="text"
                id="bookmark-url-input"
                class="w-full bg-white/10 border border-white/20 rounded-lg px-4 py-2"
                placeholder="e.g., google.com"
              />
            </div>
          </div>
          <div class="flex justify-between">
            <button
              id="bookmark-delete-btn"
              class="bg-red-500/80 text-white font-semibold px-6 py-2 rounded-lg hover:bg-red-500"
            >
              Delete
            </button>
            <button
              id="bookmark-save-btn"
              class="bg-white text-black font-semibold px-6 py-2 rounded-lg hover:bg-gray-200"
            >
              Save
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const S = {
          userName: "Vaibhav",
          weatherLocation: "Pune",
          clockFormat: "12h",
          fontSize: "medium",
          searchEngine: "brave",
          bookmarks: [],
        };

        const E = {
          html: document.documentElement,
          clock: document.getElementById("clock"),
          date: document.getElementById("date"),
          greeting: document.getElementById("greeting"),
          searchForm: document.getElementById("search-form"),
          searchInput: document.getElementById("search-input"),
          engineToggle: document.getElementById("engine-toggle"),
          braveIcon: document.getElementById("brave-icon"),
          googleIcon: document.getElementById("google-icon"),
          backgroundImage: document.getElementById("background-image"),
          weather: document.getElementById("weather"),
          weatherIconWrapper: document.getElementById("weather-icon-wrapper"),
          settingsBtn: document.getElementById("settings-btn"),
          settingsModal: document.getElementById("settings-modal"),
          settingsSaveBtn: document.getElementById("settings-save-btn"),
          helpBtn: document.getElementById("help-btn"),
          helpModal: document.getElementById("help-modal"),
          nameInput: document.getElementById("name-input"),
          locationInput: document.getElementById("location-input"),
          clockFormatSelect: document.getElementById("clock-format-select"),
          fontSizeSelect: document.getElementById("font-size-select"),
          bookmarksContainer: document.getElementById("bookmarks-container"),
          bookmarkModal: document.getElementById("bookmark-modal"),
          bookmarkModalTitle: document.getElementById("bookmark-modal-title"),
          bookmarkIdInput: document.getElementById("bookmark-id-input"),
          bookmarkNameInput: document.getElementById("bookmark-name-input"),
          bookmarkUrlInput: document.getElementById("bookmark-url-input"),
          bookmarkSaveBtn: document.getElementById("bookmark-save-btn"),
          bookmarkDeleteBtn: document.getElementById("bookmark-delete-btn"),
        };

        const today = new Date().toISOString().split("T")[0];

        function getSetting(key, defaultValue) {
          return localStorage.getItem(`homepage-${key}`) || defaultValue;
        }

        function setSetting(key, value) {
          localStorage.setItem(`homepage-${key}`, value);
        }

        function loadSettings() {
          S.userName = getSetting("userName", "Vaibhav");
          S.weatherLocation = getSetting("weatherLocation", "Pune");
          S.clockFormat = getSetting("clockFormat", "12h");
          S.fontSize = getSetting("fontSize", "medium");
          S.bookmarks = JSON.parse(getSetting("bookmarks", "[]"));
          applyFontSize();
          renderBookmarks();
        }

        function saveSettings() {
          S.userName = E.nameInput.value.trim() || "Vaibhav";
          S.weatherLocation = E.locationInput.value.trim() || "Pune";
          S.clockFormat = E.clockFormatSelect.value;
          S.fontSize = E.fontSizeSelect.value;
          setSetting("userName", S.userName);
          setSetting("weatherLocation", S.weatherLocation);
          setSetting("clockFormat", S.clockFormat);
          setSetting("fontSize", S.fontSize);
          applyFontSize();
          updateTimeAndGreeting();
          fetchWeather();
          closeModal(E.settingsModal);
        }

        function applyFontSize() {
          E.html.className = `dark font-size-${S.fontSize}`;
        }

        function openModal(modal) {
          if (modal === E.settingsModal) {
            E.nameInput.value = S.userName;
            E.locationInput.value = S.weatherLocation;
            E.clockFormatSelect.value = S.clockFormat;
            E.fontSizeSelect.value = S.fontSize;
          }
          modal.classList.remove("hidden");
        }

        function closeModal(modal) {
          modal.classList.add("hidden");
        }

        function updateTimeAndGreeting() {
          const now = new Date();
          const minutes = now.getMinutes().toString().padStart(2, "0");
          let hours = now.getHours();
          if (S.clockFormat === "12h") {
            const ampm = hours >= 12 ? "PM" : "AM";
            hours = hours % 12 || 12;
            E.clock.textContent = `${hours}:${minutes} ${ampm}`;
          } else {
            hours = hours.toString().padStart(2, "0");
            E.clock.textContent = `${hours}:${minutes}`;
          }
          E.date.textContent = now.toLocaleDateString(undefined, {
            weekday: "long",
            month: "long",
            day: "numeric",
          });
          const currentHour = now.getHours();
          let greetingText = "Good Evening";
          if (currentHour < 12) greetingText = "Good Morning";
          else if (currentHour < 18) greetingText = "Good Afternoon";
          E.greeting.textContent = `${greetingText}, ${S.userName}`;
        }

        function toggleSearchEngine() {
          S.searchEngine = S.searchEngine === "brave" ? "google" : "brave";
          E.searchInput.placeholder = `Search with ${
            S.searchEngine.charAt(0).toUpperCase() + S.searchEngine.slice(1)
          }`;
          E.braveIcon.classList.toggle("hidden");
          E.googleIcon.classList.toggle("hidden");
        }

        function renderBookmarks() {
          E.bookmarksContainer.innerHTML = "";
          S.bookmarks.forEach((bookmark) => {
            const pill = document.createElement("a");
            pill.href = bookmark.url;
            pill.className =
              "bookmark-pill relative group flex items-center bg-white/10 hover:bg-white/20 text-white rounded-full px-4 py-2 transition-all";
            pill.innerHTML = `<span>${bookmark.name}</span><button class="edit-bookmark-btn absolute -top-1 -right-1 p-1 bg-gray-700 rounded-full opacity-0 group-hover:opacity-100 transition-opacity" data-id="${bookmark.id}"><i data-lucide="pencil" class="w-3 h-3 pointer-events-none"></i></button>`;
            E.bookmarksContainer.appendChild(pill);
          });
          const addButton = document.createElement("button");
          addButton.id = "add-bookmark-btn";
          addButton.className =
            "flex items-center justify-center w-10 h-10 bg-white/10 hover:bg-white/20 text-white rounded-full transition-all";
          addButton.innerHTML = `<i data-lucide="plus" class="w-5 h-5"></i>`;
          E.bookmarksContainer.appendChild(addButton);
          lucide.createIcons();
        }

        function handleBookmarkSave() {
          const id = E.bookmarkIdInput.value;
          let url = E.bookmarkUrlInput.value.trim();
          const name = E.bookmarkNameInput.value.trim();
          if (!name || !url) return;
          if (!/^https?:\/\//i.test(url)) url = "https://" + url;
          if (id) {
            const index = S.bookmarks.findIndex((b) => b.id == id);
            if (index > -1)
              S.bookmarks[index] = { ...S.bookmarks[index], name, url };
          } else {
            S.bookmarks.push({ id: Date.now(), name, url });
          }
          setSetting("bookmarks", JSON.stringify(S.bookmarks));
          renderBookmarks();
          closeModal(E.bookmarkModal);
        }

        function handleBookmarkDelete() {
          const id = E.bookmarkIdInput.value;
          S.bookmarks = S.bookmarks.filter((b) => b.id != id);
          setSetting("bookmarks", JSON.stringify(S.bookmarks));
          renderBookmarks();
          closeModal(E.bookmarkModal);
        }

        function openBookmarkModal(bookmark = null) {
          E.bookmarkIdInput.value = bookmark ? bookmark.id : "";
          E.bookmarkNameInput.value = bookmark ? bookmark.name : "";
          E.bookmarkUrlInput.value = bookmark ? bookmark.url : "";
          E.bookmarkModalTitle.textContent = bookmark
            ? "Edit Bookmark"
            : "Add Bookmark";
          E.bookmarkDeleteBtn.style.display = bookmark ? "block" : "none";
          openModal(E.bookmarkModal);
        }

        async function fetchDailyImage() {
          const cachedDate = getSetting("imageDate", null);
          const cachedUrl = getSetting("imageUrl", null);
          if (cachedDate === today && cachedUrl) {
            E.backgroundImage.style.backgroundImage = `url('${cachedUrl}')`;
            return;
          }
          try {
            const response = await fetch(`https://picsum.photos/1920/1080`);
            if (!response.ok) throw new Error("Image fetch failed");
            E.backgroundImage.style.backgroundImage = `url('${response.url}')`;
            setSetting("imageUrl", response.url);
            setSetting("imageDate", today);
          } catch (error) {
            console.error("Background image failed to load:", error);
            E.backgroundImage.style.backgroundColor = "#1a202c";
          }
        }

        async function fetchWeather() {
          E.weather.textContent = "Loading...";
          try {
            const response = await fetch(
              `https://wttr.in/${encodeURIComponent(
                S.weatherLocation
              )}?format=j1`
            );
            if (!response.ok)
              throw new Error(`Weather service failed: ${response.status}`);
            const data = await response.json();
            const condition = data.current_condition[0];
            E.weather.textContent = `${condition.temp_C}Â°C, ${condition.weatherDesc[0].value}`;
            const iconMap = {
              113: "sun",
              116: "cloud-sun",
              119: "cloud-sun",
              122: "cloud",
              143: "wind",
              176: "cloud-drizzle",
              179: "cloud-snow",
              182: "cloud-snow",
              185: "cloud-snow",
              200: "cloud-lightning",
            };
            const iconName = iconMap[condition.weatherCode] || "sun";
            E.weatherIconWrapper.innerHTML = `<i data-lucide="${iconName}" class="w-5 h-5 opacity-80"></i>`;
          } catch (error) {
            console.error("Error fetching weather:", error);
            E.weather.textContent = "Weather unavailable";
            E.weatherIconWrapper.innerHTML = `<i data-lucide="wifi-off" class="w-5 h-5 opacity-80"></i>`;
          } finally {
            lucide.createIcons();
          }
        }

        E.engineToggle.addEventListener("click", toggleSearchEngine);
        E.searchForm.addEventListener("submit", (e) => {
          e.preventDefault();
          const query = E.searchInput.value.trim();
          if (query) {
            const url =
              S.searchEngine === "google"
                ? `https://www.google.com/search?q=${encodeURIComponent(query)}`
                : `https://search.brave.com/search?q=${encodeURIComponent(
                    query
                  )}`;
            window.location.href = url;
          }
        });
        E.bookmarksContainer.addEventListener("click", (e) => {
          const addButton = e.target.closest("#add-bookmark-btn");
          const editButton = e.target.closest(".edit-bookmark-btn");
          if (addButton) {
            openBookmarkModal();
          } else if (editButton) {
            e.preventDefault();
            const id = editButton.dataset.id;
            const bookmark = S.bookmarks.find((b) => b.id == id);
            if (bookmark) openBookmarkModal(bookmark);
          }
        });
        E.settingsBtn.addEventListener("click", () =>
          openModal(E.settingsModal)
        );
        E.helpBtn.addEventListener("click", () => openModal(E.helpModal));
        E.settingsSaveBtn.addEventListener("click", saveSettings);
        E.bookmarkSaveBtn.addEventListener("click", handleBookmarkSave);
        E.bookmarkDeleteBtn.addEventListener("click", handleBookmarkDelete);
        document
          .querySelectorAll(".modal-overlay, .modal-close-btn")
          .forEach((el) => {
            el.addEventListener("click", (e) => {
              const modal = e.target.closest(".modal");
              if (modal) closeModal(modal);
            });
          });

        loadSettings();
        updateTimeAndGreeting();
        setInterval(updateTimeAndGreeting, 1000 * 30);
        fetchDailyImage();
        fetchWeather();
        lucide.createIcons();
      });
    </script>
  </body>
</html>
